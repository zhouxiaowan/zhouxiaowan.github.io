(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{429:function(_,v,t){"use strict";t.r(v);var l=t(54),s=Object(l.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h1",{attrs:{id:"传输层协议"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#传输层协议"}},[_._v("#")]),_._v(" 传输层协议")]),_._v(" "),t("p",[_._v("目前传输层最广泛的协议是：TCP和UDP")]),_._v(" "),t("h2",{attrs:{id:"_2-1-udp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-udp"}},[_._v("#")]),_._v(" 2.1 UDP")]),_._v(" "),t("h2",{attrs:{id:"_2-2-tcp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-tcp"}},[_._v("#")]),_._v(" 2.2 TCP")]),_._v(" "),t("p",[_._v("TCP（Transmission Control Protocol）是一种面向"),t("code",[_._v("连接")]),_._v("的、"),t("code",[_._v("可靠")]),_._v("的、基于字节流的传输层通信协议，提供Host-To-Host的可靠传输。")]),_._v(" "),t("ul",[t("li",[_._v("连接：连接的目的是保证双方都在线，可以尽快的响应对方的请求。建立连接的过程就是握手过程，断开连接是挥手过程")]),_._v(" "),t("li",[_._v("可靠：指数据无损传输，发送方发送的数据和接收方接受的数据相同")])]),_._v(" "),t("p",[_._v("TCP 是一个"),t("code",[_._v("双工协议")]),_._v("，数据任何时候都可以双向传输。这就意味着客户端和服务端可以平等地发送、接收信息。正因为如此，客户端和服务端在 TCP 协议中有一个平等的名词——Host（主机）。")]),_._v(" "),t("ul",[t("li",[_._v("单工：任何一个时刻，数据只能单向发送")]),_._v(" "),t("li",[_._v("半双工：在某一时刻，数据可以向一个方向传输，也可以像相反的方向传输，而且交替进行")]),_._v(" "),t("li",[_._v("全双工：任何时刻数据都可以双向收发")])]),_._v(" "),t("p",[t("font",{attrs:{color:"#3eaf7c"}},[_._v("下面说一下三次握手和四次挥手的过程")]),t("br"),_._v("\n首先先介绍下TCP中常见的标识位：")],1),_._v(" "),t("ul",[t("li",[_._v("SYN:发起同步请求，1 表示 SYN 开启，0 表示关闭")]),_._v(" "),t("li",[_._v("ACK:响应")]),_._v(" "),t("li",[_._v("FIN:请求完成，一个HOST主动断开连接")]),_._v(" "),t("li",[_._v("PSH：数据推送，一个HOST向另一个HOST发送数据")]),_._v(" "),t("li",[_._v("RST：表示连接重置")])]),_._v(" "),t("p",[_._v("在SYN、PSH、FIN这三种情况下，接收方收到数据后都需要发送给对方一个"),t("code",[_._v("ACK")]),_._v("（响应）"),t("br"),_._v(" "),t("strong",[_._v("建立连接的过程(三次握手)：")]),_._v(" "),t("img",{attrs:{src:_.$withBase("/images/woshou.png"),alt:"三次握手"}})]),_._v(" "),t("ul",[t("li",[_._v("步骤1是第一次握手，客户端消息给客户端要建立连接")]),_._v(" "),t("li",[_._v("步骤2和步骤3是同时发生的，所以合并成一个SYN-ACK响应，作为一条数据发送给客户端，这是第二次握手")]),_._v(" "),t("li",[_._v("步骤4是第三次握手，针对服务端的SYN给个ACK（响应）")])]),_._v(" "),t("p",[t("strong",[_._v("断开连接的过程(四次挥手)：")]),_._v(" "),t("img",{attrs:{src:_.$withBase("/images/huishou.png"),alt:"四次挥手"}})]),_._v(" "),t("ul",[t("li",[_._v("步骤1是第一次挥手，客户端消息给客户端发消息请求断开连接")]),_._v(" "),t("li",[_._v("步骤2是第二次挥手，服务端根据客户端的FIN，给个ACK，作为FIN的响应")]),_._v(" "),t("li",[_._v("步骤3是第三次挥手，当服务端做好准备时发送一个FIN给客户端，表示确定可以断开连接了")]),_._v(" "),t("li",[_._v("步骤4是第四次挥手，客户端收到了服务端的FIN，当客户端处理完自己的事情后，发送一个ACK响应给服务端确定可以断开连接了"),t("br"),_._v("\n你可能在想了，为什么挥手时，步骤2和步骤3为什么不像握手时一样合并成一个请求呢，因为断开连接要处理的问题比较多，比如服务端可能还有发送出去的消息没有得到ACK，也可能服务端自己有资源需要释放，因此不能将两条请求合并成一个。所以，经过一系列的准备，服务端确定可以关闭了再发送一个FIN给客户端")])]),_._v(" "),t("h2",{attrs:{id:"_2-3-udp和tcp对比"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-udp和tcp对比"}},[_._v("#")]),_._v(" 2.3 UDP和TCP对比")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("目标差异")])])]),_._v(" "),t("ul",[t("li",[_._v("TCP的核心目标是提供可靠的网络传输")]),_._v(" "),t("li",[_._v("UDP的目标是在提供报文交换能力基础上尽可能地简化协议，轻装上阵")])]),_._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[t("strong",[_._v("连接")])])]),_._v(" "),t("ul",[t("li",[_._v("TCP是面向连接的协议,在数据传输之前必须建立连接")]),_._v(" "),t("li",[_._v("UDP是一个无连接的协议，数据随时都可以发送，只提供发送封包（Datagram）的能力")])]),_._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[t("strong",[_._v("可靠")])])]),_._v(" "),t("ul",[t("li",[_._v("TCP核心是在保证可靠性提供更好的服务，TCP需要三次握手建立连接，保证双方在线，能够收到数据。而且TCP有时间窗口持续收集无序的数据，直到这一批数据都可以合理的排序组成连续的结果")]),_._v(" "),t("li",[_._v("UDP没有TCP的特性，它只管发送数据封包，也不需要ACK（响应），只要消息发送出去，不管成功与否")])]),_._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[t("strong",[_._v("流控技术")]),_._v("\nTCP使用流控技术来确保发送方不会发送过多数据而使接收方不堪重负。TCP在"),t("code",[_._v("发送缓冲区")]),_._v("中存储数据，在"),t("code",[_._v("接受缓冲区")]),_._v("中接收数据，当应用程序准备就绪时，它将从接受缓冲区读取数据。如果"),t("code",[_._v("接受缓冲区")]),_._v("已满，接收方将无法处理更多的数据，并将其丢弃。而UDP没有这方面的能力。")]),_._v(" "),t("li",[t("strong",[_._v("传输速度")]),_._v("\nUDP协议简单，封包小，没有连接可靠性检查，单纯从速度上看，UDP更快")]),_._v(" "),t("li",[t("strong",[_._v("场景差异")])])]),_._v(" "),t("ul",[t("li",[_._v("TCP 每个数据封包都需要确认因此不适应高速数据传输场景，例如直播、音视频传输、网络游戏等等；适用于点对点文件传出（微信等）、邮件、远程控制等")]),_._v(" "),t("li",[_._v("UDP 适用于网络游戏、音视频传输、直播、DNS、RTP（实时传输协议）")]),_._v(" "),t("li",[_._v("模糊地带：HTTP（目前以 TCP 为主），http2使用的是TCP，http3开始使用UDP")])])])}),[],!1,null,null,null);v.default=s.exports}}]);